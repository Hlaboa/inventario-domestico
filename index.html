<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Gestor de almacÃ©n de cocina</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap"
    />
    <link rel="icon" href="data:," />
    <link rel="stylesheet" href="styles/styles.css" />
  </head>
  <body>
    <div class="app">


      <main class="app-main shopping-hidden">
        <!-- Panel principal -->
        <section class="panel">
          <!-- Tabs principal -->
          <div class="tabs tabs-main">
            <button
              type="button"
              id="mainAlmacenButton"
              class="tab-button active"
            >
              ALMACÃ‰N
            </button>
            <button type="button" id="mainOtrosButton" class="tab-button">
              OTROS
            </button>
            <button type="button" id="mainSelectionButton" class="tab-button">
              SELECCIÃ“N
            </button>
            <button type="button" id="mainProducersButton" class="tab-button">
              PRODUCTORES
            </button>
            <button type="button" id="mainStoresButton" class="tab-button">
              TIENDAS
            </button>
            <button type="button" id="mainClassificationButton" class="tab-button">
              CLASIFICACIÃ“N
            </button>
            <button
              type="button"
              id="mainBackupButton"
              class="tab-button tab-button-icon"
              aria-label="Copias de seguridad"
              title="Copias de seguridad"
            >
              ðŸ’¾
            </button>
            <button
              type="button"
              id="mainShoppingButton"
              class="tab-button tab-button-icon"
              aria-label="Lista de la compra"
              title="Lista de la compra"
            >
              ðŸ›’
            </button>
          </div>

          <!-- ============================
               SECCIÃ“N ALMACÃ‰N
               ============================ -->
          <section id="almacenSection" class="main-section active">
            <div class="section-mode-header panel-header">
              <div>
                <h3>Inventario de almacÃ©n</h3>
                <p class="panel-subtitle">
                  Controla tu stock del almacÃ©n, y selecciona una opciÃ³n de compra para cada producto.
                </p>
              </div>
              <div class="panel-actions">
                <button
                  type="button"
                  class="btn btn-secondary btn-small"
                  id="almacenEditModeButton"
                >
                  Editar inventario
                </button>
              </div>
            </div>

            <!-- Vista principal -->
            <div id="almacenInventoryPanel" class="sub-panel active">
              <template id="inventoryRowTemplate">
                <tr>
                  <td data-field="name"></td>
                  <td data-field="block"></td>
                  <td data-field="type"></td>
                  <td>
                    <input type="checkbox" data-field="have" />
                  </td>
                  <td data-field="shelf"></td>
                  <td data-field="quantity"></td>
                  <td class="selection-td">
                    <div class="selection-cell">
                      <button data-role="selection-btn" class="btn btn-small btn-secondary"></button>
                      <div class="selection-text" data-field="selectionText"></div>
                    </div>
                  </td>
                  <td>
                    <div class="stores-text" data-field="stores"></div>
                  </td>
                  <td data-field="acquisitionDate"></td>
                  <td data-field="expiryText"></td>
                  <td data-field="notes"></td>
                  <td>
                    <button
                      class="btn btn-small btn-icon"
                      data-role="edit"
                      aria-label="Editar producto"
                      title="Editar producto"
                    >
                      âœŽ
                    </button>
                  </td>
                </tr>
              </template>
              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addQuickProductButton"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="filterSearch">Buscar</label>
                  <input
                    type="text"
                    id="filterSearch"
                    placeholder="Producto, familia, selecciÃ³n, notas..."
                  />
                </div>
                <div class="form-group">
                  <label for="filterBlock">Familia</label>
                  <select id="filterBlock">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="filterType">Tipo</label>
                  <select id="filterType">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="filterShelf">UbicaciÃ³n</label>
                  <select id="filterShelf">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="filterStore">Tienda</label>
                  <select id="filterStore">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="filterStatus">Estado</label>
                  <select id="filterStatus">
                    <option value="all">Todos</option>
                    <option value="have">Tengo</option>
                    <option value="missing">Me falta</option>
                  </select>
                </div>
              </div>

              <div class="list-header panel-header panel-header-compact">
                <div class="summary" id="summaryInfo" aria-live="polite">
                  Total: 0 Â· Tengo: 0 Â· Faltan: 0
                </div>
              </div>

              <div class="table-wrapper" id="instancesTableWrapper">
                <div class="table-scroll">
                  <table class="product-table inventory-table">
                    <thead>
                      <tr>
                        <th scope="col">Producto</th>
                        <th scope="col">Familia</th>
                        <th scope="col">Tipo</th>
                        <th scope="col">Tengo</th>
                        <th scope="col">UbicaciÃ³n</th>
                        <th scope="col">Cantidad</th>
                        <th scope="col" class="selection-col">SelecciÃ³n</th>
                        <th scope="col">Tiendas</th>
                        <th scope="col">AdquisiciÃ³n</th>
                        <th scope="col">Caducidad</th>
                        <th scope="col">Notas</th>
                        <th scope="col" aria-label="Acciones"></th>
                      </tr>
                    </thead>
                    <tbody id="productTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Modo ediciÃ³n -->
            <div id="almacenEditPanel" class="sub-panel">
              <div class="grid-header panel-header">
                <div>
                  <h2>Editar inventario</h2>
                  <p class="panel-subtitle">
                    Gestiona los productos del almacÃ©n domÃ©stico.
                  </p>
                </div>
                <div class="extra-header-actions panel-actions">
                  <button
                    type="button"
                    class="btn btn-secondary btn-small"
                    id="addGridRowButton"
                  >
                    AÃ±adir producto
                  </button>
                  <button
                    type="button"
                    class="btn btn-primary btn-small"
                    id="saveGridButton"
                  >
                    Guardar cambios
                  </button>
                </div>
              </div>

              <div class="filters filters-edit">
                <div class="form-group search-group">
                  <label for="editFilterSearch">Buscar en ediciÃ³n</label>
                  <input
                    type="text"
                    id="editFilterSearch"
                    placeholder="Producto, notas, selecciÃ³n..."
                  />
                </div>
                <div class="form-group">
                  <label for="editFilterFamily">Familia</label>
                  <select id="editFilterFamily">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="editFilterType">Tipo</label>
                  <select id="editFilterType">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="editFilterShelf">UbicaciÃ³n</label>
                  <select id="editFilterShelf">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="editFilterStore">Tienda</label>
                  <select id="editFilterStore">
                    <option value="">Todas</option>
                  </select>
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <template id="inventoryEditRowTemplate">
                    <tr>
                      <td data-slot="name"></td>
                      <td data-slot="block"></td>
                      <td data-slot="type"></td>
                      <td data-slot="have"></td>
                      <td data-slot="shelf"></td>
                      <td data-slot="quantity"></td>
                      <td class="selection-td">
                        <div class="selection-cell">
                          <span class="selection-text" data-field="selectionText"></span>
                          <button
                            class="btn btn-small btn-icon"
                            data-role="selection-btn"
                            aria-label="Seleccionar productor y tiendas"
                            title="Seleccionar productor y tiendas"
                          >
                            +
                          </button>
                        </div>
                      </td>
                      <td>
                        <div class="stores-text" data-field="stores"></div>
                      </td>
                      <td data-slot="acquisitionDate"></td>
                      <td data-slot="expiryText"></td>
                      <td data-slot="notes"></td>
                      <td>
                        <button
                          class="btn btn-small btn-icon"
                          data-role="move"
                          aria-label="Mover a otros productos"
                          title="Mover a otros productos"
                        >
                          â†’
                        </button>
                        <button class="btn btn-small btn-danger" data-role="delete" aria-label="Eliminar producto">âœ•</button>
                      </td>
                    </tr>
                  </template>
                  <table class="product-table table-inventory-edit">
                    <colgroup>
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                    </colgroup>
                    <thead>
                      <tr>
                        <th scope="col">Producto</th>
                        <th scope="col">Familia</th>
                        <th scope="col">Tipo</th>
                        <th scope="col">Tengo</th>
                        <th scope="col">UbicaciÃ³n</th>
                        <th scope="col">Cantidad</th>
                        <th scope="col" class="selection-col">SelecciÃ³n</th>
                        <th scope="col">Tiendas</th>
                        <th scope="col">F. adquisiciÃ³n</th>
                        <th scope="col">Caducidad</th>
                        <th scope="col">Notas</th>
                        <th scope="col">Acciones</th>
                      </tr>
                    </thead>
                    <tbody id="gridTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>

          <!-- ============================
               SECCIÃ“N CLASIFICACIÃ“N
               ============================ -->
          <section id="classificationSection" class="main-section">
            <div class="section-mode-header panel-header">
              <div>
                <h3>ClasificaciÃ³n de productos</h3>
                <p class="panel-subtitle">
                  Gestiona la ontologÃ­a de productos con familias y tipos.
                </p>
              </div>
              <div class="extra-header-actions panel-actions"></div>
            </div>

              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addClassificationButton"
                    title="AÃ±adir combinaciÃ³n"
                    aria-label="AÃ±adir combinaciÃ³n"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="classificationSearch">Buscar</label>
                  <input
                    type="text"
                    id="classificationSearch"
                    placeholder="Familia, tipo, notas..."
                  />
                </div>
                <div class="form-group">
                  <label for="classificationFamilyFilter">Familia</label>
                  <select id="classificationFamilyFilter">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="classificationTypeFilter">Tipo</label>
                  <select id="classificationTypeFilter">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-primary btn-small btn-quick-add"
                    id="saveClassificationsButton"
                    title="Guardar"
                    aria-label="Guardar"
                  >
                    âœ“
                  </button>
                </div>
              </div>
              <div class="list-header panel-header panel-header-compact">
                <div
                  class="summary"
                  id="classificationSummaryInfo"
                  aria-live="polite"
                >
                  Total: 0
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                <template id="classificationRowTemplate">
                  <tr>
                    <td data-slot="block"></td>
                    <td data-slot="type"></td>
                    <td data-slot="notes"></td>
                    <td>
                      <button class="btn btn-small btn-danger btn-trash" data-role="delete" aria-label="Eliminar" title="Eliminar">
                        ðŸ—‘
                      </button>
                    </td>
                  </tr>
                </template>
                <table class="product-table">
                  <thead>
                    <tr>
                      <th scope="col">Familia</th>
                      <th scope="col">Tipo</th>
                      <th scope="col">Notas</th>
                      <th scope="col" aria-label="Eliminar"></th>
                    </tr>
                  </thead>
                  <tbody id="classificationTableBody"></tbody>
                </table>
              </div>
            </div>
          </section>

          <!-- ============================
               SECCIÃ“N OTROS PRODUCTOS
               ============================ -->
          <section id="otrosSection" class="main-section">
            <div class="section-mode-header panel-header">
              <div>
                <h2>Otros productos</h2>
                <p class="panel-subtitle">
                  Organiza el resto de productos fuera del almacÃ©n, y aÃ±Ã¡delos a la lista de la compra.
                </p>
              </div>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="otrosEditModeButton"
              >
                Editar lista
              </button>
            </div>

            <!-- Vista rÃ¡pida -->
            <div id="otrosListPanel" class="sub-panel active">
              <template id="extraQuickRowTemplate">
                <tr>
                  <td data-field="name"></td>
                  <td data-field="block"></td>
                  <td data-field="type"></td>
                  <td data-field="buy">
                    <input type="checkbox" data-field="buy" />
                  </td>
                  <td data-field="quantity"></td>
                  <td class="selection-td">
                    <div class="selection-cell">
                      <button data-role="selection-btn" class="btn btn-small btn-secondary"></button>
                      <div class="selection-text" data-field="selectionText"></div>
                    </div>
                  </td>
                  <td data-field="stores"></td>
                  <td data-field="notes"></td>
                  <td>
                    <button
                      type="button"
                      class="btn btn-small btn-icon"
                      data-role="edit"
                      aria-label="Editar producto"
                      title="Editar producto"
                    >
                      âœŽ
                    </button>
                  </td>
                </tr>
              </template>

              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addQuickExtraButton"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="extraFilterSearch">Buscar</label>
                  <input
                    type="text"
                    id="extraFilterSearch"
                    placeholder="Producto, familia, tipo, notas..."
                  />
                </div>
                <div class="form-group">
                  <label for="extraFilterFamily">Familia</label>
                  <select id="extraFilterFamily">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="extraFilterType">Tipo</label>
                  <select id="extraFilterType">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="extraFilterStore">Tienda</label>
                  <select id="extraFilterStore">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="extraFilterBuy">Comprar</label>
                  <select id="extraFilterBuy">
                    <option value="all">Todos</option>
                    <option value="yes">SÃ­</option>
                    <option value="no">No</option>
                  </select>
                </div>
              </div>

              <div class="list-header panel-header panel-header-compact">
                <div class="summary" id="extraSummaryInfo" aria-live="polite">
                  Total: 0 Â· Comprar: 0
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <template id="extraEditRowTemplate">
                    <tr>
                      <td data-slot="name"></td>
                      <td data-slot="block"></td>
                      <td data-slot="type"></td>
                      <td data-slot="buy"></td>
                      <td data-slot="quantity"></td>
                      <td class="selection-td">
                        <div class="selection-cell">
                          <span class="selection-text" data-field="selectionText"></span>
                          <button
                            class="btn btn-small btn-icon"
                            data-role="selection-btn"
                            aria-label="Seleccionar productor y tiendas"
                            title="Seleccionar productor y tiendas"
                          >
                            +
                          </button>
                        </div>
                      </td>
                      <td><span data-field="stores"></span></td>
                      <td data-slot="notes"></td>
                      <td>
                        <button
                          class="btn btn-small btn-icon"
                          data-role="edit"
                          aria-label="Editar producto"
                          title="Editar producto"
                        >
                          âœŽ
                        </button>
                      </td>
                    </tr>
                  </template>
                  <table class="product-table table-extra-edit">
                    <colgroup>
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                      <col />
                    </colgroup>
                    <thead>
                      <tr>
                        <th scope="col">Producto</th>
                        <th scope="col">Familia</th>
                        <th scope="col">Tipo</th>
                      <th scope="col">Comprar</th>
                      <th scope="col">Cantidad</th>
                      <th scope="col" class="selection-col">SelecciÃ³n</th>
                      <th scope="col">Tiendas</th>
                      <th scope="col">Notas</th>
                      <th scope="col" aria-label="Acciones"></th>
                    </tr>
                    </thead>
                    <tbody id="extraListTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- EdiciÃ³n otros productos -->
            <div id="otrosEditPanel" class="sub-panel">
              <div class="extra-header panel-header">
                <div>
                  <h2>Editar otros productos</h2>
                  <p class="panel-subtitle">
                    Gestiona los productos que no estÃ¡n en el almacÃ©n principal.
                  </p>
                </div>
                <div class="extra-header-actions panel-actions">
                  <button
                    type="button"
                    class="btn btn-secondary btn-small"
                    id="addExtraRowButton"
                  >
                    AÃ±adir producto
                  </button>
                  <button
                    type="button"
                    class="btn btn-primary btn-small"
                    id="saveExtraButton"
                  >
                    Guardar cambios
                  </button>
                </div>
              </div>

              <div class="filters filters-edit">
                <div class="form-group search-group">
                  <label for="extraEditFilterSearch">Buscar</label>
                  <input
                    type="text"
                    id="extraEditFilterSearch"
                    placeholder="Producto, notas, selecciÃ³n..."
                  />
                </div>
                <div class="form-group">
                  <label for="extraEditFilterFamily">Familia</label>
                  <select id="extraEditFilterFamily">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="extraEditFilterType">Tipo</label>
                  <select id="extraEditFilterType">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="extraEditFilterStore">Tienda</label>
                  <select id="extraEditFilterStore">
                    <option value="">Todas</option>
                  </select>
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <table class="product-table">
                    <thead>
                      <tr>
                        <th scope="col">Producto</th>
                        <th scope="col">Familia</th>
                        <th scope="col">Tipo</th>
                        <th scope="col">Comprar</th>
                        <th scope="col">Cantidad</th>
                        <th scope="col" class="selection-col">SelecciÃ³n</th>
                        <th scope="col">Tiendas</th>
                        <th scope="col">Notas</th>
                        <th scope="col">Mover a almacÃ©n</th>
                      </tr>
                    </thead>
                    <tbody id="extraTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>

          <!-- ============================
               SECCIÃ“N TIENDAS/PRODUCTORES
               ============================ -->
          <section id="proveedoresSection" class="main-section">
            <!-- Productores -->
            <div id="producersPanel" class="sub-panel">
              <div class="panel-header">
                <div>
                  <h3>Productores</h3>
                  <p class="panel-subtitle">
                    Gestiona tus productores y sus notas.
                  </p>
                </div>
                <div class="panel-actions"></div>
              </div>
              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addProducerButton"
                    title="AÃ±adir productor"
                    aria-label="AÃ±adir productor"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="producersSearch">Buscar</label>
                  <input
                    type="text"
                    id="producersSearch"
                    placeholder="Nombre, notas..."
                  />
                </div>
                <div class="form-group">
                  <label for="producersLocationFilter">LocalizaciÃ³n</label>
                  <select id="producersLocationFilter">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-primary btn-small btn-quick-add"
                    id="saveProducersButton"
                    title="Guardar"
                    aria-label="Guardar"
                  >
                    âœ“
                  </button>
                </div>
              </div>
              <div class="list-header panel-header panel-header-compact">
                <div class="summary" id="producersSummaryInfo" aria-live="polite">
                  Total: 0
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <template id="producersRowTemplate">
                    <tr>
                      <td data-slot="name"></td>
                      <td data-slot="location"></td>
                      <td data-slot="notes"></td>
                      <td>
                        <button
                          class="btn btn-small btn-danger btn-trash"
                          data-role="delete"
                          aria-label="Eliminar selecciÃ³n"
                          title="Eliminar selecciÃ³n"
                        >
                          ðŸ—‘
                        </button>
                      </td>
                    </tr>
                  </template>
                  <table class="product-table">
                  <thead>
                    <tr>
                      <th scope="col">Nombre productor</th>
                      <th scope="col">LocalizaciÃ³n</th>
                      <th scope="col">Notas</th>
                      <th scope="col" aria-label="Eliminar"></th>
                    </tr>
                  </thead>
                    <tbody id="producersTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- Tiendas -->
            <div id="storesPanel" class="sub-panel">
              <div class="panel-header">
                <div>
                  <h3>Tiendas</h3>
                  <p class="panel-subtitle">
                    Administra las tiendas donde compras, tipos y forma de contacto.
                  </p>
                </div>
                <div class="panel-actions"></div>
              </div>
              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addStoreButton"
                    title="AÃ±adir tienda"
                    aria-label="AÃ±adir tienda"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="storesSearch">Buscar</label>
                  <input
                    type="text"
                    id="storesSearch"
                    placeholder="Nombre, web, notas..."
                  />
                </div>
                <div class="form-group">
                  <label for="storesTypeFilter">Tipo</label>
                  <select id="storesTypeFilter">
                    <option value="">Todos</option>
                    <option value="fisico">FÃ­sico</option>
                    <option value="online">Online</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="storesLocationFilter">LocalizaciÃ³n</label>
                  <select id="storesLocationFilter">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-primary btn-small btn-quick-add"
                    id="saveStoresButton"
                    title="Guardar"
                    aria-label="Guardar"
                  >
                    âœ“
                  </button>
                </div>
              </div>
              <div class="list-header panel-header panel-header-compact">
                <div class="summary" id="storesSummaryInfo" aria-live="polite">
                  Total: 0
                </div>
              </div>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <template id="storesRowTemplate">
                    <tr>
                      <td data-slot="name"></td>
                      <td data-slot="type"></td>
                      <td data-slot="location"></td>
                      <td data-slot="website"></td>
                      <td data-slot="notes"></td>
                      <td>
                        <button
                          class="btn btn-small btn-danger btn-trash"
                          data-role="delete"
                          aria-label="Eliminar"
                          title="Eliminar"
                        >
                          ðŸ—‘
                        </button>
                      </td>
                    </tr>
                  </template>
                  <table class="product-table">
                  <thead>
                    <tr>
                      <th scope="col">Nombre tienda</th>
                      <th scope="col">Tipo</th>
                      <th scope="col">LocalizaciÃ³n</th>
                      <th scope="col">Web / contacto</th>
                      <th scope="col">Notas</th>
                      <th scope="col" aria-label="Eliminar"></th>
                    </tr>
                  </thead>
                    <tbody id="storesTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>

            <!-- SelecciÃ³n de productos (instancias) -->
            <div id="instancesPanel" class="sub-panel active">
              <div class="panel-header">
                <div>
                  <h3>SelecciÃ³n de productos</h3>
                  <p class="panel-subtitle">
                    Gestiona alternativas distintas para cada producto (productor, marca y tiendas).
                  </p>
                </div>
                <div class="panel-actions"></div>
              </div>
              <div class="filters filters-edit">
                <div class="form-group quick-add-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-secondary btn-small btn-quick-add"
                    id="addInstanceButton"
                    title="AÃ±adir selecciÃ³n"
                    aria-label="AÃ±adir selecciÃ³n"
                  >
                    +
                  </button>
                </div>
                <div class="form-group search-group">
                  <label for="instancesSearch">Buscar</label>
                  <input
                    type="text"
                    id="instancesSearch"
                    placeholder="Producto, productor, marca, tienda..."
                  />
                </div>
                <div class="form-group">
                  <label for="instancesFamilyFilter">Familia</label>
                  <select id="instancesFamilyFilter">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="instancesProducerFilter">Productor</label>
                  <select id="instancesProducerFilter">
                    <option value="">Todos</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="instancesStoreFilter">Tienda</label>
                  <select id="instancesStoreFilter">
                    <option value="">Todas</option>
                  </select>
                </div>
                <div class="form-group">
                  <label>&nbsp;</label>
                  <button
                    type="button"
                    class="btn btn-primary btn-small btn-quick-add"
                    id="saveInstancesButton"
                    title="Guardar"
                    aria-label="Guardar"
                  >
                    âœ“
                  </button>
                </div>
              </div>
              <div class="list-header panel-header panel-header-compact">
                <div class="summary" id="instancesSummaryInfo" aria-live="polite">
                  Total: 0
                </div>
              </div>

              <!-- datalist para autocompletar productos -->
              <datalist id="productsDatalist"></datalist>

              <div class="table-wrapper">
                <div class="table-scroll">
                  <template id="instancesRowTemplate">
                    <tr>
                      <td data-slot="productName"></td>
                      <td data-field="family"></td>
                      <td data-slot="producer"></td>
                      <td data-slot="brand"></td>
                      <td data-slot="stores"></td>
                      <td data-slot="notes"></td>
                      <td>
                        <button class="btn btn-small btn-danger" data-role="delete" aria-label="Eliminar">âœ•</button>
                      </td>
                    </tr>
                  </template>
                  <table class="product-table">
                  <thead>
                    <tr>
                      <th scope="col">Producto</th>
                      <th scope="col">Familia</th>
                      <th scope="col">Productor</th>
                      <th scope="col">Marca</th>
                      <th scope="col">Tiendas</th>
                      <th scope="col">Notas</th>
                      <th scope="col"></th>
                    </tr>
                  </thead>
                    <tbody id="instancesTableBody"></tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>
        </section>

        <!-- Panel lista de la compra -->
        <section id="shoppingSection" class="side-panel">
          <template id="shoppingStoreTemplate">
            <div class="shopping-store-block">
              <div class="shopping-store-header">
                <span class="shopping-store-title"></span>
                <span class="shopping-store-count"></span>
              </div>
              <ul class="shopping-store-items"></ul>
            </div>
          </template>
          <template id="shoppingItemTemplate">
            <li>
              <div class="shopping-item-main"></div>
              <div class="shopping-item-meta"></div>
            </li>
          </template>
          <div class="list-header panel-header">
            <div>
              <h2>Lista de la compra</h2>
              <p class="panel-subtitle">
                Tu lista de la compra.
              </p>
            </div>
              <div class="shopping-actions panel-actions">
              <button
                type="button"
                class="btn btn-primary btn-small btn-quick-add"
                id="copyListButton"
                title="Copiar lista"
                aria-label="Copiar lista"
              >
                ðŸ“Ž
              </button>
            </div>
          </div>

          <div class="summary" id="shoppingSummary" aria-live="polite">
            0 producto(s) Â· 0 tienda(s)
          </div>

          <div id="shoppingListContainer"></div>

        </section>

        <!-- Panel de copias de seguridad -->
        <section id="backupSection" class="side-panel">
          <div class="section-mode-header panel-header">
            <div>
              <h3>Copias de seguridad</h3>
              <p class="panel-subtitle">
                Exporta o restaura tus datos.
              </p>
            </div>
            <div class="panel-actions"></div>
          </div>
          <div class="filters filters-edit">
            <div class="form-group quick-add-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="exportBackupButton"
                title="Descargar copia (.json)"
                aria-label="Descargar copia (.json)"
              >
                Descargar copia (.json)
              </button>
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="importBackupButton"
                title="Restaurar desde archivo"
                aria-label="Restaurar desde archivo"
              >
                Restaurar desde archivo
              </button>
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="exportAlmacenCsvButton"
                title="AlmacÃ©n a Excel"
                aria-label="AlmacÃ©n a Excel"
              >
                Exportar almacÃ©n a Excel
              </button>
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="exportOtrosCsvButton"
                title="Otros productos a Excel"
                aria-label="Otros productos a Excel"
              >
                Exportar otros a Excel
              </button>
            </div>
            <div class="form-group">
              <label>&nbsp;</label>
              <button
                type="button"
                class="btn btn-secondary btn-small"
                id="exportStoresCsvButton"
                title="Tiendas a Excel"
                aria-label="Tiendas a Excel"
              >
                Exportar tiendas a Excel
              </button>
            </div>
          </div>
          <div class="list-header panel-header panel-header-compact">
            <p class="backup-note">
              Incluye almacÃ©n, otros productos, selecciÃ³n, productores, tiendas y clasificaciÃ³n.
            </p>
          </div>
          <input
            type="file"
            id="backupFileInput"
            accept="application/json"
            style="display: none"
          />
        </section>
      </main>
    </div>

    <!-- Popup para elegir SelecciÃ³n de producto -->
    <div id="selectionPopupOverlay" class="selection-popup-overlay">
      <div id="selectionPopup" class="selection-popup">
        <div class="selection-popup-header">
          <span
            id="selectionPopupTitle"
            class="selection-popup-title"
            >Seleccionar producto</span
          >
          <button
            type="button"
            class="btn btn-secondary btn-small"
            id="selectionPopupClose"
          >
            âœ•
          </button>
        </div>
        <div class="selection-popup-body">
          <p class="selection-popup-help">
            Selecciona el productor, marca y tiendas para este producto.
          </p>
          <ul id="selectionPopupList"></ul>
        </div>
      </div>
    </div>

    <!-- LibrerÃ­a para Excel (.xlsx) -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="src/core/utils.js"></script>
    <script src="src/core/components.js"></script>
    <script src="src/core/storage.js"></script>
    <script src="src/core/state.js"></script>
    <script src="src/core/dataService.js"></script>
    <script src="src/core/appStore.js"></script>
    <script src="src/core/stateAdapter.js"></script>
    <script src="src/core/bootstrap.js"></script>
    <script src="src/core/uiHelpers.js"></script>
    <script src="src/core/backup.js"></script>
    <script src="src/controllers/viewControllers.js"></script>
    <script src="src/controllers/inventoryController.js"></script>
    <script src="src/controllers/extraController.js"></script>
    <script src="src/controllers/instancesController.js"></script>
    <script src="src/controllers/classificationController.js"></script>
    <script src="src/controllers/producersController.js"></script>
    <script src="src/controllers/storesController.js"></script>
    <script src="src/views/classificationView.js"></script>
    <script src="src/views/producersView.js"></script>
    <script src="src/views/storesView.js"></script>
    <script src="src/views/instancesView.js"></script>
    <script src="src/views/inventoryView.js"></script>
    <script src="src/views/inventoryEditView.js"></script>
    <script src="src/views/extrasView.js"></script>
    <script src="src/views/extraEditView.js"></script>
    <script src="src/views/autocomplete.js"></script>
    <script src="src/views/selectionPopup.js"></script>
    <script src="src/features/inventory.js"></script>
    <script src="src/features/extras.js"></script>
    <script src="src/features/producers.js"></script>
    <script src="src/features/stores.js"></script>
    <script src="src/features/instances.js"></script>
    <script src="src/app.js"></script>
  </body>
</html>
